<?xml version="1.0" encoding="utf-8"?>
<direct>

 [ <chain ipv="ipv4" table="nat" chain="overcloud_masquerade"/> ]
 [ <rule ipv="ipv4" table="nat" chain="POSTROUTING" priority="0"> -j overcloud_masquerade </rule> ]
 [ <rule ipv="ipv4" table="nat" chain="overcloud_masquerade" priority="0"> -s 172.20.0.0/16 -d 172.20.0.0/16 -j RETURN </rule> ]
 [ <rule ipv="ipv4" table="nat" chain="overcloud_masquerade" priority="0"> -s 172.20.0.0/16 -j MASQUERADE </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i ctlplane0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i ctlplane1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i ctlplane2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i ctlplane3 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i external0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i external1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i external2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i external3 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant0 -o tenant1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant0 -o tenant2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant0 -o tenant3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant1 -o tenant0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant1 -o tenant2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant1 -o tenant3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant2 -o tenant0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant2 -o tenant1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant2 -o tenant3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant3 -o tenant0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant3 -o tenant1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i tenant3 -o tenant2 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage0 -o storage1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage0 -o storage2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage0 -o storage3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage1 -o storage0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage1 -o storage2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage1 -o storage3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage2 -o storage0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage2 -o storage1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage2 -o storage3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage3 -o storage0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage3 -o storage1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storage3 -o storage2 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt0 -o storagemgmt1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt0 -o storagemgmt2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt0 -o storagemgmt3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt1 -o storagemgmt0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt1 -o storagemgmt2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt1 -o storagemgmt3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt2 -o storagemgmt0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt2 -o storagemgmt1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt2 -o storagemgmt3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt3 -o storagemgmt0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt3 -o storagemgmt1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i storagemgmt3 -o storagemgmt2 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi0 -o intapi1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi0 -o intapi2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi0 -o intapi3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi1 -o intapi0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi1 -o intapi2 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi1 -o intapi3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi2 -o intapi0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi2 -o intapi1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi2 -o intapi3 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi3 -o intapi0 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi3 -o intapi1 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="FORWARD" priority="0"> -i intapi3 -o intapi2 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="INPUT" priority="0"> -i ctlplane0 -p udp -m udp --dport 67:68 --sport 67:68 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="INPUT" priority="0"> -i ctlplane1 -p udp -m udp --dport 67:68 --sport 67:68 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="INPUT" priority="0"> -i ctlplane2 -p udp -m udp --dport 67:68 --sport 67:68 -j ACCEPT </rule> ]
 [ <rule ipv="ipv4" table="filter" chain="INPUT" priority="0"> -i ctlplane3 -p udp -m udp --dport 67:68 --sport 67:68 -j ACCEPT </rule> ]

 [ <rule ipv="ipv4" table="filter" chain="INPUT" priority="0"> -p udp -m udp -m multiport --dports 6230:6238 -j ACCEPT </rule> ]
</direct>

